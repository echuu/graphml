---
title: "STAT 650 HW 1"
author: "Eric Chuu (626008871)"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Problem 1. See the comments in the code below for responses to the questions.

```{r warnings = FALSE, message = FALSE}
suppressWarnings(library(dplyr))
suppressWarnings(library(ggplot2))
car_full = read.csv("car.csv", stringsAsFactors = FALSE)
# (a) extract columns of interest
car = car_full[,c(2,22,37,46)]
car = car[-3017,] # remove mercedes from dataset per instructions
# (b) rename columns
names(car) = c("maker","weight","type","fe")
# (c) extract only car models with gas engines
car_gas = car %>% dplyr::filter(type == "Tier 2 Cert Gasoline")
```
(d) The first plot below is unhelpful because of the presence of a strong outlier (large FE value). We remove this outlier and replot the data. It appears that the higher the weight, the lower the fe.
```{r, out.width="80%", warnings = FALSE}
ggplot(car_gas, aes(weight, fe)) + geom_point()
ggplot(car_gas[car_gas$fe != max(car_gas$fe, na.rm = TRUE),], aes(weight, fe)) + 
  geom_point()
```

(e)
```{r}
summary(car_gas$fe)
summary(car_gas$weight)
```

(f) From the output below, we see that on average, honda has the highest FE and GM has the lowest FE. 
```{r}
honda = subset(car_gas, maker == 'Honda')
toyota = subset(car_gas, maker == 'Toyota')
gm = subset(car_gas, maker == 'GM')
ford = subset(car_gas, maker == 'FOMOCO')
mean(honda$fe)
mean(toyota$fe)
mean(gm$fe)
mean(ford$fe)
```

(g) 
```{r, out.width="75%"}
boxplot(subset(car_gas, maker == "Honda")$fe, subset(car_gas, maker == "Toyota")$fe,
        subset(car_gas, maker == "GM")$fe, subset(car_gas, maker == "FOMOCO")$fe,
        xlab = 'car manufacturer', title = 'comparing FE across different car manufacturers')
```

```{r, out.width="75%"}
car_gas_sub = car_gas[car_gas$maker %in% c("Honda","Toyota", "GM", "FOMOCO"),]
ggplot(data = car_gas_sub , aes(x = maker , y = fe , color = maker)) +
  geom_boxplot()+ ylab("Fuel Efficiency (MPG)") + xlab("Auto Maker")
```


(h) From the boxplots, it seems like toyota and honda is best positioned for the next oil crisis because they both have the highest fuel efficiencyamong the four in consideration. 

## Problem 2.

\noindent (a) The probability in question is $P( \textrm{A wins} \mid \textrm{open B})$. By Bayes' rule, we have the following:
$$ P( \textrm{A wins} \mid \textrm{open B}) = \frac{P( \textrm{open B} \mid \textrm{A wins} ) P ( \textrm{A wins} )}{P( \textrm{open B})} $$
In the beginning, every door has equal probability of having the car behind it, so $P(\textrm{A wins}) = 1/3$. From the problem statement, $P( \textrm{open B} \mid \textrm{A wins} ) = 1/2$. We use the law of total probability to compute $P(B)$. 
\[
\begin{aligned}
  P(\textrm{open B}) = P( \textrm{open B} \mid \textrm{A wins}) P(\textrm{A wins}) + P( \textrm{open B} \mid \textrm{C wins}) P(\textrm{C wins}) 
  = \frac{1}{2}\cdot \frac{1}{3} + 1\cdot \frac{1}{3} 
  = \frac{1}{2}.
\end{aligned}
\]
Plugging this into the previous equation, we have
$$ P( \textrm{A wins} \mid \textrm{open B}) = \frac{1}{3}. $$


\noindent (b) Using the calculations from part (a), we can compute the following probability,
\[
\begin{aligned}
  P( \textrm{C wins} \mid \textrm{open B}) = \frac{P( \textrm{open B} \mid \textrm{C wins} ) P ( \textrm{C wins} )}{P( \textrm{open B})} 
  = \frac{1/3 \cdot 1}{1/2} 
  = \frac{2}{3}.
\end{aligned}
\]
We see that if we switch from door A to door C, the probability of winning is 2/3, rather than 1/3 if we stick with door A. 

\noindent (c) The results are counterintuitive, but an application of basic probability leads you to the optimal decision. We could verify the results by writing a simulation where we ran randomly assign a door to have the car behind it and repeatedly adopt the strategies in (a) and (b), keeping track of the results. After many iterations, we can see if the proportion of wins matches with the theoretical probabilities that we've compute in the previous parts. 


### Problem 3.

\noindent (a) Find $P(X_1 = 2 \textrm{ or } X_2 = 2)$.

\textbf{Solution.} We calculate the desired quantity by considering the complement,
$$ P(X_1 = 2 \textrm{ or } X_2 = 2) = 1 - P \left[ (X_1 = 2 \textrm{ or } X_2 = 2)^c\right] =  1 - P \left[ X_1 \neq 2 \textrm{ and } X_2 \neq 2 \right]$$
where $A^c$ denotes the complement of the event $A$. We consider the events in question: in order for $X_1 \neq 2$, we either have $X_1 = 1$ or $X_1 = 0$, but we are provided with the assumption that there are 2 active nodes to start the first epoch, so ther cannot be 0 active nodes at the end of the first epoch, so we must have $X_1 = 1$. Further for $X_2 \neq 2$, we either have $X_2 = 1$ or $X_2 = 0$, but $\{ X_2 = 1 \textrm{ and } X_1 = 1 \}$ implies that no transmission attempts occurred during the second epoch while one transmission attempt occurred during the first epoch, but we know that exactly 2 transmission attempts occur. This must mean that $X_2 = 0$. Putting this together, we have the following equality:
\[
\begin{aligned}
   P(X_1 = 2 \textrm{ or } X_2 = 2) &= 1 - P \left[ X_1 \neq 2 \textrm{ and } X_2 \neq 2 \right] \\
   &= 1 - P \left[ X_1 = 1 \textrm{ and } X_2 = 0 \right] \\
   &= 1 - P \left[ X_2 = 0 \mid X_1 = 1 \right] P \left[ X_1 = 1 \right] \\
   &= 1 - \left[ p (1-q)(1-p) \right] \left[ 2 p(1-p) \right]
\end{aligned}
\]

\noindent (b) Find the probability that at least one of these attempts occurred during epoch 2. 

\textbf{Solution.} Equivalently, we compute $1 - P\left( \textrm{no attempts occurred in epoch 2} \right)$. Both attempts occurred in epoch 1 (with probability $p^2$), followed by neither node attempting to transmit in epoch 2 (with probability $(1-p)^2$. Putting this together,
\[
  P\left( \textrm{no attempts occurred in epoch 2} \right) = 1 - p^2 (1-p)^2.
\]



### Problem 4. Consider a three-node version of the ALOHA network example, with all nodes active at time 0. One of the users tells us at the end of epoch 1 that her node was involved in a collision during that epoch. (We have no information from the other two users.) 

\noindent (i) What is the probability that all three nodes were involved in that collision? 

\textbf{Solution.} Since we know that one of the users was involved in a collision during epoch 1, then we know already that there was at least one other node attempted transmission. The probability that all three nodes were involved in the collision is then simply the probability that the remaining node attempts transmission, which occurs with probability $p$. 

\noindent (ii) How will the probability change if none of the nodes is active at time 0?

\textbf{Solution.} Using the same argument as above in (i), we only need to compute the probability that the remaining node generates a message and attempts to transmit this message, which gives us probability $q\cdot p$. 






