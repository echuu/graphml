"0","library(mlbench)
library(caret)
library(gmodels)
library(e1071)
data(""HouseVotes84"")
set.seed(650600)
x = HouseVotes84
n = nrow(x) # number of data points

trainIndex = createDataPartition(x$Class, p = 0.7, list = FALSE, times = 1)
xtrain = x[trainIndex,]
xtest = x[-trainIndex,]

nb_fit = naiveBayes(Class ~ ., data = xtrain)

# (a) immigration -> V11
nb_fit$tables$V11
"
"1","            V11
"
"1","Y           "
"1","         n"
"1","         y"
"1","
  democrat  "
"1"," 0.5168539"
"1"," 0.4831461"
"1","
  republican"
"1"," 0.8750000"
"1"," 0.1250000"
"1","
"
"0","# (b) education spending -> V13"
"0","nb_fit$tables$V13"
"1","            V13
"
"1","Y           "
"1","         n"
"1","         y"
"1","
  democrat  "
"1"," 0.6742857"
"1"," 0.3257143"
"1","
  republican"
"1"," 0.1801802"
"1"," 0.8198198"
"1","
"
"0","# (c)"
"0","ytest_hat = predict(nb_fit, xtest)"
"0","CrossTable(xtest$Class, ytest_hat)"
"1","
"
"1"," "
"1","
"
"1","   Cell Contents
"
"1","|-------------------------|
"
"1","|                       N |
"
"1","| Chi-square contribution |
"
"1","|           N / Row Total |
"
"1","|           N / Col Total |
"
"1","|         N / Table Total |
"
"1","|-------------------------|
"
"1","
"
"1"," "
"1","
"
"1","Total Observations in Table: "
"1"," "
"1","130"
"1"," "
"1","
"
"1","
"
"1"," "
"1","
"
"1","            "
"1"," "
"1","|"
"1"," "
"1","ytest_hat"
"1"," "
"1","
"
"1"," xtest$Class"
"1"," | "
"1","  democrat"
"1"," | "
"1","republican"
"1"," | "
"1"," Row Total"
"1"," | "
"1","
"
"1","-------------"
"1","|"
"1","------------"
"1","|"
"1","------------"
"1","|"
"1","------------"
"1","|"
"1","
"
"1","    democrat"
"1"," | "
"1","        72"
"1"," | "
"1","         8"
"1"," | "
"1","        80"
"1"," | "
"1","
"
"1","            "
"1"," | "
"1","    15.376"
"1"," | "
"1","    20.319"
"1"," | "
"1","          "
"1"," | "
"1","
"
"1","            "
"1"," | "
"1","     0.900"
"1"," | "
"1","     0.100"
"1"," | "
"1","     0.615"
"1"," | "
"1","
"
"1","            "
"1"," | "
"1","     0.973"
"1"," | "
"1","     0.143"
"1"," | "
"1","          "
"1"," | "
"1","
"
"1","            "
"1"," | "
"1","     0.554"
"1"," | "
"1","     0.062"
"1"," | "
"1","          "
"1"," | "
"1","
"
"1","-------------"
"1","|"
"1","------------"
"1","|"
"1","------------"
"1","|"
"1","------------"
"1","|"
"1","
"
"1","  republican"
"1"," | "
"1","         2"
"1"," | "
"1","        48"
"1"," | "
"1","        50"
"1"," | "
"1","
"
"1","            "
"1"," | "
"1","    24.602"
"1"," | "
"1","    32.510"
"1"," | "
"1","          "
"1"," | "
"1","
"
"1","            "
"1"," | "
"1","     0.040"
"1"," | "
"1","     0.960"
"1"," | "
"1","     0.385"
"1"," | "
"1","
"
"1","            "
"1"," | "
"1","     0.027"
"1"," | "
"1","     0.857"
"1"," | "
"1","          "
"1"," | "
"1","
"
"1","            "
"1"," | "
"1","     0.015"
"1"," | "
"1","     0.369"
"1"," | "
"1","          "
"1"," | "
"1","
"
"1","-------------"
"1","|"
"1","------------"
"1","|"
"1","------------"
"1","|"
"1","------------"
"1","|"
"1","
"
"1","Column Total"
"1"," | "
"1","        74"
"1"," | "
"1","        56"
"1"," | "
"1","       130"
"1"," | "
"1","
"
"1","            "
"1"," | "
"1","     0.569"
"1"," | "
"1","     0.431"
"1"," | "
"1","          "
"1"," | "
"1","
"
"1","-------------"
"1","|"
"1","------------"
"1","|"
"1","------------"
"1","|"
"1","------------"
"1","|"
"1","
"
"1","
"
"1"," "
"1","
"
