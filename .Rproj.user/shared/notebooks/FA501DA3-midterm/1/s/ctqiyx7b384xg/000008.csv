"0","set.seed(1)
# (a)
dsep(bn = res, x = ""Proteins"", y = ""Pressure"") 
"
"1","[1]"
"1"," FALSE"
"1","
"
"0","# (b)"
"0","dsep(bn = res, x = ""Proteins"", y = ""Pressure"", z = c('Smoking', 'M..Work'))"
"1","[1]"
"1"," TRUE"
"1","
"
"0","# (c)"
"0","bp_140 = bn_df[bn_df$Pressure == '>140',] # rows where blood pressure > 140"
"0","nrow(bp_140[bp_140$Smoking == 'yes',]) / nrow(bp_140) # probability of smoker"
"1","[1]"
"1"," 0.433291"
"1","
"
"0","# compare to cpquery result"
"0","res.fit = bn.fit(res, data = bn_df) "
"0","cpquery(res.fit, event = (Smoking == ""yes""), evidence = (Pressure == '>140'))"
"1","[1]"
"1"," 0.4335632"
"1","
"
"0","# (d)"
"0","protein_3 = bn_df[bn_df$Proteins == '<3',]"
"0","nrow(protein_3[protein_3$Pressure == '>140',]) / nrow(protein_3)"
"1","[1]"
"1"," 0.3920829"
"1","
"
"0","cpquery(res.fit, event = (Pressure == "">140""), evidence = (Proteins == '<3'))"
"1","[1]"
"1"," 0.4322512"
"1","
"
